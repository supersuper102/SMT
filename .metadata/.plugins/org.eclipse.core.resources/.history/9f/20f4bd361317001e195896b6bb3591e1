<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %>

<style>
#tth {
	font-size: 13pt;
	font-weight: bold;
	background-color: rgb(253, 227, 227);
	text-align: center;
}

tr:not(:first-child) {
	font-size: 12pt;
	color: black;
	text-align: center;
}

tr:not(:first-child) td:nth-child(2) {
	text-align: left;
}

#lbtn {
	text-align: right;
	font-size: 15pt;
}

input {
	border: solid 1px #f56a6a;
}

#login_join {
	display: none;
}

.chat-box {
	width: 50%;
	margin: 0 auto;
	position: fixed;
	bottom: 0;
	left: 0;
	right: 0;
}

.message-input {
	width: 100%;
	height: 40px;
	font-size: 14px;
	border: 1px solid #ccc;
}

.message-list {
	margin-top: 10px;
}

.message-right {
	text-align: right;
}

.message-left {
	text-align: left;
	color: blue;
}

</style>

<!-- Banner -->

<!-- Section -->
<div class="chat-box">
	<table>
		<tr id="tth">
			<td>채팅</td>
		</tr>
		<tr>
			<td>
				<div class="message-list" id="messageList">
					<p class="message-left">안녕하세요 궁금하신 내용을 물어보세요!</p>
				</div>
			</td>
		</tr>
		<tr>
			<td>
				<input type="text" class="message-input" id="messageInput" />
				<button onclick="sendMessage()">전송</button>
			</td>
		</tr>
	</table>
</div>

<script>
function sendMessage() {
	var messageInput = document.getElementById("messageInput");
	var messageList = document.getElementById("messageList");
	var message = messageInput.value;

	messageList.innerHTML += "<p class='message-right'>" + message + "</p>"; // 입력한 메시지를 오른쪽에 추가

	// ChatGPT로부터 답변을 받아와서 왼쪽에 추가하는 부분을 작성해야 합니다.
	// AJAX 요청 등을 사용하여 서버와 통신하여 답변을 받아오는 방식을 구현하셔야 합니다.
	// 아래 코드는 ChatGPT 답변을 가정한 예시입니다.
	var answer = getAnswerFromChatGPT(message); // ChatGPT로부터 답변을 받아오는 함수
	messageList.innerHTML += "<p class='message-left'>" + answer + "</p>"; // 답변 내용을 왼쪽에 추가

	messageInput.value = ""; // 전송 후 입력 필드 초기화
}

// ChatGPT로부터 답변을 받아오는 함수 (가정한 예시)
function getAnswerFromChatGPT(question) {
	// ChatGPT와 통신하여 질문에 대한 답변을 받아오는 로직을 구현해야 합니다.
	// 아래
	// 아래는 ChatGPT로부터 답변을 받아오는 함수를 가정한 예시입니다.
function getAnswerFromChatGPT(question) {
	// ChatGPT와 통신하여 질문에 대한 답변을 받아오는 로직을 구현해야 합니다.
	// AJAX 요청 등을 사용하여 서버와 통신하여 ChatGPT API를 호출하고 답변을 받아옵니다.
	// 아래는 예시 코드입니다.

	var xhr = new XMLHttpRequest();
	xhr.open("POST", "/chatGPT", true); // ChatGPT API에 요청하는 URL을 설정해야 합니다.

	xhr.setRequestHeader("Content-Type", "application/json");
	xhr.onreadystatechange = function () {
		if (xhr.readyState === 4 && xhr.status === 200) {
			var response = JSON.parse(xhr.responseText);
			var answer = response.answer; // 서버에서 받아온 답변을 추출합니다.
			displayAnswer(answer); // 받아온 답변을 화면에 표시하는 함수를 호출합니다.
		}
	};

	var requestBody = JSON.stringify({ question: question });
	xhr.send(requestBody);
}

// ChatGPT의 답변을 화면에 표시하는 함수
function displayAnswer(answer) {
	var messageList = document.getElementById("messageList");
	messageList.innerHTML += "<p class='message-left'>" + answer + "</p>"; // 답변 내용을 왼쪽에 추가
}

// 엔터 키를 눌렀을 때 전송되도록 설정
document.getElementById("messageInput").addEventListener("keyup", function (event) {
	if (event.keyCode === 13) {
		sendMessage();
	}
});
</script>

